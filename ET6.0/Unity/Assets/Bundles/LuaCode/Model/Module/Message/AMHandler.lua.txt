-- Generated by CSharp.lua Compiler
local System = System
local ET
System.import(function (out)
  ET = out.ET
end)
System.namespace("ET", function (namespace)
  namespace.class("AMHandler_1", function (namespace)
    return function (Message)
      local Handle, GetMessageType
      Handle = function (this, session, msg)
        return System.async(function (async, this, session, msg)
          local message = System.as(msg, Message)
          if message == nil then
            ET.Log.Error("消息类型转换错误: " .. msg:GetType():getName() .. " to " .. System.typeof(Message):getName())
            return
          end
          if session:getIsDisposed() then
            ET.Log.Error("session disconnect " .. System.toString(msg))
            return
          end

          System.try(function ()
            async:Await(this:Run(session, message))
          end, function (default)
            local e = default
            ET.Log.Error1(e)
          end)
        end, nil, this, session, msg)
      end
      GetMessageType = function (this)
        return System.typeof(Message)
      end
      return {
        base = function (out)
          return {
            out.ET.IMHandler
          }
        end,
        Handle = Handle,
        GetMessageType = GetMessageType
      }
    end
  end)
end)
