-- Generated by CSharp.lua Compiler
local System = System
local Linq = System.Linq.Enumerable
local DCETRuntime = DCETRuntime
local ET = ET
local UnityEngine = UnityEngine
local ArrayString = System.Array(System.String)
System.namespace("ET", function (namespace)
  namespace.class("Init", function (namespace)
    local Start, Update, LateUpdate, OnApplicationQuit
    Start = function (this)
      System.try(function ()
        System.SynchronizationContext.SetSynchronizationContext(ET.OneThreadSynchronizationContext.getInstance())

        UnityEngine.Object.DontDestroyOnLoad(this:getgameObject())

        local assemblyNames = ArrayString("Unity.Model.dll", "Unity.Hotfix.dll", "Unity.ModelView.dll", "Unity.HotfixView.dll")

        for _, assembly in System.each(System.AppDomain.getCurrentDomain():GetAssemblies()) do
          local continue
          repeat
            local assemblyName = assembly:getManifestModule():getName()
            if not Linq.Contains(assemblyNames, assemblyName) then
              continue = true
              break
            end
            ET.Game.getEventSystem():Add(assembly)
            continue = true
          until 1
          if not continue then
            break
          end
        end

        DCETRuntime.LuaHelper.StartHotfix()
        --Game.EventSystem.Publish(new EventType.AppStart());
      end, function (default)
        local e = default
        ET.Log.Error(e)
      end)
    end
    Update = function (this)
      ET.OneThreadSynchronizationContext.getInstance():Update()
      ET.Game.getEventSystem():Update()
    end
    LateUpdate = function (this)
      ET.Game.getEventSystem():LateUpdate()
    end
    OnApplicationQuit = function (this)
      ET.Game.Close()
    end
    return {
      base = function (out)
        return {
          out.UnityEngine.MonoBehaviour
        }
      end,
      Start = Start,
      Update = Update,
      LateUpdate = LateUpdate,
      OnApplicationQuit = OnApplicationQuit
    }
  end)
end)
